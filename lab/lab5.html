
<html lang="en">
<head>
  <title>LAB 5</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Oswald:700' rel='stylesheet' type='text/css'>
</head>
<body>
	
<!-- Navigation -->
	<nav class="navbar navbar-inverse navbar-static-top" role="navigation">
	  <div class="container">
		<div class="navbar-header">
		  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		  <ul class="nav navbar-nav">
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io">MainPage</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab1.html">LAB 1</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab2.html">LAB 2</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab3.html">LAB 3</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab4.html">LAB 4</a></li>
			  <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#about">LAB 5</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab6.html">LAB 6</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab7.html">LAB 7</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab8.html">LAB 8</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab9.html">LAB 9</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab10.html">LAB 10</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab11.html">LAB 11</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab12.html">LAB 12</a></li>
			  <li class="nav-item"><a class="nav-link" href="https://leewx1020.github.io/lab/lab13.html">LAB 13</a></li>
			 	  
		  </ul>
		</div>
	  </div>
	</nav>
	
	

	      
	<div id="main_content_wrap" class="outer">
	<section id="main_content" class="inner">
	<article class="mb-4">
        <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-md-9 col-lg-9 col-xl-9">    
          
  <h2 id="lab-5">Lab 5 - Motors and Open Loop Control</h2>
          
  <h3 id="prelab-diagram">Prelab: Diagram</h3>
          
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/diagram.jpeg" alt=""width="500" height="500"/>        
          <p>The picture above shows the diagram with your intended connections between the motor drivers, Artemis, 
	   and the battery (with a specific pin number). I check the Artemis datasheet and find all the pin with the "~" sign. 
	   That means it can have a PWM signal. For the left motor drive, I choose pin 6 and 7. 
	   And for the right side motor driver, I choose pin 15 and 16.</p> 
          
  <h3 id="prelab-battery-discussion">Prelab: Battery Discussion</h3>
        <p>We have two battery choices in total. For the motor, I choose the 850mA to charge it. 
	Compared with the Artemis board, these two motors will cost more energy and use more current to make it works, 
	so it is necessary to have a battery with a larger capacity. 
	Also, using two separate batteries can make sure the Artemis and motors can work independently to make it debug easily.</p>
          
          
          
          
  <h3 id="task-1">Task 1: Dual Motor Driver and PWM Testing</h3>
          
       <p>In this task, I test the left side motor as I draw in the diagram shown in the prelab. 
	The code to generate PWM signals is also shown below. 
	I set up the pin number and then use the analogWrite to get the power for the motor driver output. 
	The PWM range is ranging from 0 to 255, so I choose a number almost in the middle to test it. 
	Here, we still need to use the external power supply. I set the voltage as 3.7V, which is the same as the battery provided in this course. 
	The voltage can not be too high, otherwise, the Artemis will be broken. </p>
		
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/pwm.jpeg" alt=""width="500" height="500"/>
	<p>I use the red and black wire from the power supply to connect the Vin and GND of the motor driver. 
	Two black wires from the oscilloscope should also be connected to the GND. 
	And the two red wires will connect with these two wires from the "out" side of the motor driver. 
	The connection is shown at the very beginning of the video below. And as you can see, on the screen of the oscilloscope, 
	the voltage oscillates in the proper range, which is what we expected.</p>
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/YM-BYB00HXk"  
  frameborder="0" allowfullscreen></iframe>
		
		
  <h3 id="task-2">Task 2: One Wheels Spinning</h3>
	<p>I unscrew the top blue shell from the car, and then cut the LEDs and PCB wires. 
	There are three sets of wires (red as Vin and black as ground) we have to connect, two for the motors and one for the battery. 
	First, I mount one side of the motor and use the external power supply to see if the wheels can move both forward and backward. 
	The code below is what I used to make the wheel move in both directions. 
	The pin I use is 15 and 16. The meaning of my code is that the car moves forward for one second, 
	next, stops for one second, then moves backward, and stops for one second. </p>
          
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/one_wheel.jpeg" alt=""width="500" height="500"/>
		
	<p>The video below shows that one side of the wheel works well and this is charged by an external power supply.</p>
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/rTFAOSG13yw"  
  frameborder="0" allowfullscreen></iframe>
		
	<p>The second video is charged by the battery by soldering the Vin and Ground from both motor driver with the red and black wires from the RC car.</p>
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/gkE81e1Km4k"  
  frameborder="0" allowfullscreen></iframe>
		
		
		
		
  <h3 id="task">Task 3: Both Wheels Spinning</h3>
	<p>To drive both motors together, we just have to make some small changes based on task 2. 
	It requires defining the pin connected with the other side of the motor, which is pins 6 and 7.  
	In the void loop, the logic is the same as the code from task 2 with the PIN changes. The picture below is the Arduino code I use.</p> 	
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/both.jpeg" alt=""width="500" height="500"/>
	<p>The video below represents the wheel from both sides can work well with the 850mAh battery.</p>
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/TMqaou4Puac"  
  frameborder="0" allowfullscreen></iframe>		
		
		
		
  <h3 id="task">Task 4: Components Secured in the Car</h3>
		
          <p>The picture below is all the components secured in the car and I clearly labeled the important components. </p>
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/setup.jpeg" alt=""width="500" height="500"/>        
		
		
  <h3 id="task">Task 5: PWM Value Discussion</h3>
          
	<p>To find the lower limit of the PWM, I change the PWM value from the analogWrite. 
	Starting from 10, I gradually add up the value and test it on the floor to see whether it is effective to move. 
	After several test, I found around 45 is the lower limit of the PWM.</p>	
		
		
          
  <h3>Task 6: Calibration Demonstration</h3>
        <p>I set the PWM value as 50 to do the calibration implementation. 
	When I set the same PWM value to both motors. 
	As you can see in the video shown below, the RC car is drifting to the left.</p>
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/WZrQN9cw3T8"  
  frameborder="0" allowfullscreen></iframe>
		
	ã€€<p>To calibrate that, I have to increase the PWM value of the left-side motor to increase the voltage applied to the motor, 
	which will increase the wheel speed. After several tries, I found that if the PWM value from the left side can be times 2, 
	the car can almost move in a straight line. In the video below, there is still a little bit of drifting to the left. 
	It is because the starting direction is not strictly straight, so it will cause some inevitable error. </p>
		
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/9eu41opSFGk"  
  frameborder="0" allowfullscreen></iframe>		
	
		
  <h3>Task 7: Open Loop Code and Video</h3>   
          
	<p>The video and the code below shows how the car acts when I add an extra set of code to make it turn right.</p>
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/turn.jpeg" alt=""width="500" height="500"/>
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/tdH2jmt4xBE"  
  frameborder="0" allowfullscreen></iframe>      
          
          
          
  <h3>Additional task for 5000-level Students</h3>      
  <h3>Task 1: AnalogWrite Frequency Discussion</h3>
          
  <img class="img-responsive" src="https://leewx1020.github.io/lab_pic/lab5/sc.jpeg" alt=""width="500" height="500"/> 
	<p>As you can see above, this is the screenshot in the video of the PWM signal in task 1. 
	Each horizontal block represents 2.5ms, so the period of the PWM signal is about 5.5ms. 
	Therefore, the frequency is 1/5.5ms = 182Hz. In labs 3 and 4, we experimentally found the speed to get ToF and IMU data. 
	ToF is 30ms and IMU is about 2-5ms. So the frequency for ToF is smaller than motors, 
	and the frequency for the IMU is almost the same as the motors. 
	So, the frequency for the PWM signal is fast enough to catch and then make some reaction based on the surrounding environments. 
	If we generate a faster PWM signal, the motor can respond more quickly in some extreme situations. </p>
          
          
  <h3>Task 2: Lowest PWM Value Speed Discussion</h3>
   	<p>Due to the static friction being larger than the friction of the car moving,
	we have to set a larger initial speed to drive the motor to start to move. 
	So I set the starting PWM value as 60. 
	And by doing several experiments, I found the time that robot settles at its slowest speed is 500 ms and the lowest PWM 
	value at which you can keep the robot running once it is in motion is 40. As you can see in the video below, the car moves very slowly. 
	When I try below 40, the motor is not effective in the car moving.   </p>     
  <iframe width="560" height="315"  
  src="https://www.youtube.com/embed/L47YHgjaQmI"  
  frameborder="0" allowfullscreen></iframe>        
          
          
